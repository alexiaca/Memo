/**
 * grrd's Memo
 * Copyright (c) 2020 Gerard Tyedmers, grrd@gmx.net
 * @license MPL-2.0
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
!function(){"use strict";var e=0;const t=[{desc:"grrd’s Memo is a HTML5 Game that works offline.",help:"Flip the cards and find the pairs. Is your memory good enough to remember?",themes:"Theme",themes_txt:["Animals","Flowers","Masha"],cards:"Cards",players:"Players",start:"Start",dev:"Developed by Gérard Tyedmers.",look:"Have a look at my other games:",and:"and",begin:"begins.",play:"plays",has:"has now",win:"wins with",pair:"pair.",pairs:"pairs.",pairs2:"pairs.",tries:"lCards pairs revealed in lTries attempts.",draw:"draw",player:"Player",turn:"'s turn.",won:"has won!",score:"Score:",draw2:"This game ends in a draw."},{desc:"grrd's Tic Tac Toe ist ein HTML5 Spiel, welches offline funktioniert",help:"Dreh die Karten um und finde die Paare. Ist dein Gedächtnis gut genug?",themes:"Thema",themes_txt:["Tiere","Blumen","Mascha"],cards:"Karten",players:"Spieler",start:"Start",dev:"Entwickelt von Gérard Tyedmers.",look:"Schau dir auch meine anderen Spiele an: ",and:"und",begin:"beginnt.",play:"spielt",has:"hat nun",win:"gewinnt mit",pair:"Paar.",pairs:"Paare.",pairs2:"Paaren.",tries:"lCards Paare in lTries Versuchen aufgedeckt.",draw:"unentschieden",player:"Spieler",turn:"ist am Zug.",won:"hat gewonnen!",score:"Resultat:",draw2:"Diese Partie endet unentschieden."}],n=function(e){return document.getElementById(e)},s=n("iPopupInfo"),a=n("iPopupScore"),i=n("iTitle"),r=n("iGame");let l;const o=n("grid").getElementsByClassName("flip-container");let d,c=[],p=24;const m=["animals","flowers","mascha"];let u=0;const g=[6,12,24,32,48];let h,L=2,w=2,f=[],y=[];function v(e){for(d=e.length-1;d>0;d-=1){const t=Math.floor(Math.random()*(d+1));[e[d],e[t]]=[e[t],e[d]]}return e}function T(){s.classList.remove("popup-init"),s.classList.remove("popup-hide"),s.classList.add("popup-show")}function M(){s.classList.remove("popup-show"),s.classList.add("popup-hide")}function E(s){let a=parseInt(s.target.getAttribute("data-step"));u+a>=0&&u+a<m.length&&(u+=a,n("lTheme").innerHTML=t[e].themes_txt[u])}function b(e){let t=parseInt(e.target.getAttribute("data-step"));L+t>=0&&L+t<g.length&&(L+=t,n("lCards").innerHTML=g[L])}function k(e){let t=parseInt(e.target.getAttribute("data-step"));w+t>0&&w+t<6&&(w+=t,n("lPlayers").innerHTML=w)}function H(){let e=.7*Math.sqrt((document.documentElement.clientHeight-40)*document.documentElement.clientWidth/g[L]);n("grid").setAttribute("style","grid-template-columns: repeat(auto-fill, minmax("+e+"px, 1fr))"),document.getElementsByTagName("header")[0].setAttribute("style","display: flex; flex-wrap: wrap;"),n("iStart").getBoundingClientRect().bottom>window.innerHeight&&document.getElementsByTagName("header")[0].setAttribute("style","display: flex; flex-wrap: nowrap;")}function C(s){if(!s.classList.contains("turned")&&(2===c.length&&(c[0].classList.remove("turned"),c[1].classList.remove("turned"),c=[]),c.push(s),y[h]+=1,2===c.length&&(c[0].getElementsByClassName("image")[0].src===c[1].getElementsByClassName("image")[0].src?(f[h]+=1,1===f[h]?n("iMessage").innerHTML=t[e].player+" "+(h+1)+" "+t[e].has+" "+f[h]+" "+t[e].pair:n("iMessage").innerHTML=t[e].player+" "+(h+1)+" "+t[e].has+" "+f[h]+" "+t[e].pairs,c=[]):((h+=1)===w&&(h=0),n("iMessage").innerHTML=t[e].player+" "+(h+1)+" "+t[e].turn)),s.classList.toggle("turned"),document.getElementsByClassName("turned").length===g[L])){let s=f.indexOf(Math.max(...f)),i=Math.max(...f);n("lWinner").innerHTML=1===w?t[e].tries.replace("lCards",g[L]/2).replace("lTries",y[0]/2):t[e].player+" "+(s+1)+" "+t[e].win+" "+i+" "+t[e].pairs2,a.classList.remove("popup-init"),a.classList.remove("popup-hide"),a.classList.add("popup-show")}}function x(){let s=[],a=[];for(n("grid").innerHTML="",f=new Array(w).fill(0),y=new Array(w).fill(0),h=0,c=[],n("iMessage").innerHTML=t[e].player+" 1 "+t[e].begin,d=0;d<p;d+=1)s.push(d+1);for(v(s),d=0;d<g[L]/2;d+=1)a.push(s[d]),a.push(s[d]);for(v(a),d=0;d<g[L];d+=1)(l=document.getElementsByClassName("dummy")[0].getElementsByClassName("flip-container")[0].cloneNode(!0)).getElementsByClassName("image")[0].src="images/"+m[u]+"/"+a[d]+".jpg",n("grid").appendChild(l);for(d=0;d<o.length;d+=1)o[d].onclick=function(e){C(this)};H(),i.classList.remove("swipe-out-right"),r.classList.remove("swipe-in-left"),i.classList.add("swipe-out"),r.classList.add("swipe-in")}function P(){i.classList.remove("swipe-out"),r.classList.remove("swipe-in"),i.classList.add("swipe-out-right"),r.classList.add("swipe-in-left"),a.classList.remove("popup-show"),a.classList.add("popup-hide")}window.addEventListener("resize",function(){H()}),function(){const s=(function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);return null!==t&&t[1]}("lang")||navigator.language||navigator.browserLanguage||(navigator.languages||["en"])[0]).substring(0,2).toLowerCase();"de"===s?e=1:"fr"===s&&(e=2),e&&document.documentElement.setAttribute("lang",s),n("lThemeLabel").innerHTML=t[e].themes+": ",n("lTheme").innerHTML=t[e].themes_txt[u],n("lCardsLabel").innerHTML=t[e].cards+": ",n("lPlayersLabel").innerHTML=t[e].players+": ",n("lDev").innerHTML=t[e].dev,n("lInstr").innerHTML=t[e].help,n("lLook").innerHTML=t[e].look,document.querySelector("meta[name='description']").setAttribute("content",t[e].desc),n("iInfo").addEventListener("click",T),n("iInfoClose").addEventListener("click",M),n("iNextTheme").addEventListener("click",E),n("iPrevTheme").addEventListener("click",E),n("iCardsUp").addEventListener("click",b),n("iCardsDown").addEventListener("click",b),n("iPlayersUp").addEventListener("click",k),n("iPlayersDown").addEventListener("click",k),n("iStart").addEventListener("click",x),n("iClose").addEventListener("click",P),n("iOK").addEventListener("click",P),H()}()}();