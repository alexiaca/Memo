/**
 * grrd's Memo
 * Copyright (c) 2020 Gerard Tyedmers, grrd@gmx.net
 * @license MPL-2.0
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
!function(){"use strict";let e=0;const t=[{desc:"grrd’s Memo is a HTML5 Game that works offline.",help:"Flip the cards and find the pairs. Is your memory good enough to remember?",themes:"Theme",themes_txt:["Animals","Flowers","Masha"],cards:"Cards",players:"Players",start:"Start",dev:"Developed by Gérard Tyedmers.",look:"Have a look at my other games:",and:"and",begin:"begins.",play:"plays",has:"has now",win:"wins with",pair:"pair.",pairs:"pairs.",pairs2:"pairs.",tries:"lCards pairs revealed in lTries attempts.",draw:"draw",player:"Player",turn:"'s turn.",won:"has won!",score:"Score:",draw2:"This game ends in a draw."},{desc:"grrd's Tic Tac Toe ist ein HTML5 Spiel, welches offline funktioniert",help:"Dreh die Karten um und finde die Paare. Ist dein Gedächtnis gut genug?",themes:"Thema",themes_txt:["Tiere","Blumen","Mascha"],cards:"Karten",players:"Spieler",start:"Start",dev:"Entwickelt von Gérard Tyedmers.",look:"Schau dir auch meine anderen Spiele an: ",and:"und",begin:"beginnt.",play:"spielt",has:"hat nun",win:"gewinnt mit",pair:"Paar.",pairs:"Paare.",pairs2:"Paaren.",tries:"lCards Paare in lTries Versuchen aufgedeckt.",draw:"unentschieden",player:"Spieler",turn:"ist am Zug.",won:"hat gewonnen!",score:"Resultat:",draw2:"Diese Partie endet unentschieden."}],n=function(e){return document.getElementById(e)},s=n("iPopupInfo"),a=n("iPopupScore"),i=n("iTitle"),r=n("iGame"),l=n("grid");let o;const d=l.getElementsByClassName("flip-container");let c,p=[],m=24;const u=["animals","flowers","mascha"];let h=0;const g=[6,12,24,32,48];let L,f=2,w=2,y=[],T=[];function v(e){for(c=e.length-1;c>0;c-=1){const t=Math.floor(Math.random()*(c+1));[e[c],e[t]]=[e[t],e[c]]}return e}function M(){s.classList.remove("popup-init"),s.classList.remove("popup-hide"),s.classList.add("popup-show")}function E(){s.classList.remove("popup-show"),s.classList.add("popup-hide")}function C(s){let a=parseInt(s.target.getAttribute("data-step"));h+a>=0&&h+a<u.length&&(h+=a,n("lTheme").innerHTML=t[e].themes_txt[h])}function b(e){let t=parseInt(e.target.getAttribute("data-step"));f+t>=0&&f+t<g.length&&(f+=t,n("lCards").innerHTML=g[f])}function k(e){let t=parseInt(e.target.getAttribute("data-step"));w+t>0&&w+t<6&&(w+=t,n("lPlayers").innerHTML=w)}function H(){let e=.7*Math.sqrt((document.documentElement.clientHeight-40)*document.documentElement.clientWidth/g[f]);l.setAttribute("style","grid-template-columns: repeat(auto-fill, minmax("+e+"px, 1fr))"),document.getElementsByTagName("header")[0].setAttribute("style","display: flex; flex-wrap: wrap;"),n("iStart").getBoundingClientRect().bottom>window.innerHeight&&document.getElementsByTagName("header")[0].setAttribute("style","display: flex; flex-wrap: nowrap;")}function P(s){return function(){!function(s){if(!s.classList.contains("turned")&&(2===p.length&&(p[0].classList.remove("turned"),p[1].classList.remove("turned"),p=[]),p.push(s),T[L]+=1,2===p.length&&(p[0].getElementsByClassName("image")[0].src===p[1].getElementsByClassName("image")[0].src?(y[L]+=1,1===y[L]?n("iMessage").innerHTML=t[e].player+" "+(L+1)+" "+t[e].has+" "+y[L]+" "+t[e].pair:n("iMessage").innerHTML=t[e].player+" "+(L+1)+" "+t[e].has+" "+y[L]+" "+t[e].pairs,p=[]):((L+=1)===w&&(L=0),n("iMessage").innerHTML=t[e].player+" "+(L+1)+" "+t[e].turn)),s.classList.toggle("turned"),document.getElementsByClassName("turned").length===g[f])){let s=y.indexOf(Math.max(...y)),i=Math.max(...y);n("lWinner").innerHTML=1===w?t[e].tries.replace("lCards",g[f]/2).replace("lTries",T[0]/2):t[e].player+" "+(s+1)+" "+t[e].win+" "+i+" "+t[e].pairs2,a.classList.remove("popup-init"),a.classList.remove("popup-hide"),a.classList.add("popup-show")}}(s)}}function N(){let s=[],a=[];for(l.innerHTML="",y=new Array(w).fill(0),T=new Array(w).fill(0),L=0,p=[],n("iMessage").innerHTML=t[e].player+" 1 "+t[e].begin,c=0;c<m;c+=1)s.push(c+1);for(v(s),c=0;c<g[f]/2;c+=1)a.push(s[c]),a.push(s[c]);for(v(a),c=0;c<g[f];c+=1)(o=document.getElementsByClassName("dummy")[0].getElementsByClassName("flip-container")[0].cloneNode(!0)).getElementsByClassName("image")[0].src="images/"+u[h]+"/"+a[c]+".jpg",l.appendChild(o);for(c=0;c<d.length;c+=1)d[c].onclick=P(d[c]);H(),i.classList.remove("swipe-out-right"),r.classList.remove("swipe-in-left"),i.classList.add("swipe-out"),r.classList.add("swipe-in")}function x(){a.classList.remove("popup-show"),a.classList.add("popup-hide"),setTimeout(function(){i.classList.remove("swipe-out"),r.classList.remove("swipe-in"),i.classList.add("swipe-out-right"),r.classList.add("swipe-in-left")},1e3)}window.addEventListener("resize",function(){H()}),function(){const s=(function(e){let t=new URLSearchParams(window.location.search);return!!t.has(e)&&t.get(e)}("lang")||navigator.language||navigator.browserLanguage||(navigator.languages||["en"])[0]).substring(0,2).toLowerCase();"de"===s?e=1:"fr"===s&&(e=2),e&&document.documentElement.setAttribute("lang",s),n("lThemeLabel").innerHTML=t[e].themes+": ",n("lTheme").innerHTML=t[e].themes_txt[h],n("lCardsLabel").innerHTML=t[e].cards+": ",n("lPlayersLabel").innerHTML=t[e].players+": ",n("lDev").innerHTML=t[e].dev,n("lInstr").innerHTML=t[e].help,n("lLook").innerHTML=t[e].look,document.querySelector("meta[name='description']").setAttribute("content",t[e].desc),n("iInfo").addEventListener("click",M),n("iInfoClose").addEventListener("click",E),n("iNextTheme").addEventListener("click",C),n("iPrevTheme").addEventListener("click",C),n("iCardsUp").addEventListener("click",b),n("iCardsDown").addEventListener("click",b),n("iPlayersUp").addEventListener("click",k),n("iPlayersDown").addEventListener("click",k),n("iStart").addEventListener("click",N),n("iClose").addEventListener("click",x),n("iOK").addEventListener("click",x),document.querySelectorAll(".popup-head").forEach(function(e){e.appendChild(document.getElementsByClassName("title1")[0].cloneNode(!0)),e.appendChild(document.getElementsByClassName("title2")[0].cloneNode(!0))}),H()}()}();