/**
 * grrd's Memo
 * Copyright (c) 2020 Gerard Tyedmers, grrd@gmx.net
 * @license MPL-2.0
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
!function(){"use strict";let e=0;const t=[{desc:"grrd’s Memo is a HTML5 Game that works offline.",help:"Flip the cards and find the pairs. Is your memory good enough to remember?",themes_txt:["Animals","Flowers","Masha"],cards:"Cards",player:"Player",players:"Players",start:"Play",dev:"Developed by Gérard Tyedmers.",look:"Have a look at my other games:",begin:"begins.",has:"has now",and:"and",win:"wins with",win2:"win with",pair:"pair",pairs:"pairs",pairs2:"pairs",tries:"tries",rank:"rank",stats:"lCards pairs revealed in lTries attempts.",turn:"lPlayer 's turn."},{desc:"grrd's Memo ist ein HTML5 Spiel, welches offline funktioniert",help:"Dreh die Karten um und finde die Paare. Ist dein Gedächtnis gut genug?",themes_txt:["Tiere","Blumen","Mascha"],cards:"Karten",player:"Spieler",players:"Spieler",start:"Start",dev:"Entwickelt von Gérard Tyedmers.",look:"Schau dir auch meine anderen Spiele an: ",begin:"beginnt.",has:"hat nun",and:"und",win:"gewinnt mit",win2:"gewinnen mit",pair:"Paar",pairs:"Paare",pairs2:"Paaren",tries:"Versuche",rank:"Rang",stats:"lCards Paare in lTries Versuchen aufgedeckt.",turn:"lPlayer ist am Zug."},{desc:"grrd's Memo est un jeu en HTML5 qui fonctionne hors ligne.",help:"Retournez les cartes et trouvez les paires. Votre mémoire est-elle assez bonne?",themes_txt:["Animaux","Fleurs","Mascha"],cards:"Cartes",player:"Joueur",players:"Joueurs",start:"Jouer",dev:"Développé par Gérard Tyedmers.",look:"Regardez aussi mes autres jeux: ",begin:"commence.",has:"a maintenant",and:"et",win:"gagne avec",win2:"gagnent avec",pair:"paire",pairs:"paires",pairs2:"paires",tries:"Essais",rank:"Rang",stats:"lCards paires révélées en lTries essais.",turn:"Au tour du lPlayer."},{desc:"grrd's Memo es un juego HTML5 que funciona fuera de línea.",help:"Voltea las cartas y encuentra los pares. ¿Es tu memoria lo suficientemente buena?",themes_txt:["Animales","Flores","Masha"],cards:"Cartas",player:"Jugador",players:"Jugadores",start:"Juega",dev:"Desarrollado por Gérard Tyedmers.",look:"Echa un vistazo a mis otros juegos:",begin:"comienza.",has:"tiene ahora",and:"y",win:"gana con",win2:"ganan con",pair:"par",pairs:"pares",pairs2:"pares",tries:"intentos",rank:"rango",stats:"lCards pares revelados en lTries intentos.",turn:"Turno del lPlayer"}],s=function(e){return document.getElementById(e)},n=s("iPopupInfo"),a=s("iPopupScore"),r=s("iTitle"),i=s("iGame"),l=s("tScore"),o=s("lDev"),d=document.getElementsByClassName("title2card"),c=s("grid");let u;const m=c.getElementsByClassName("flip-container");let p,g=[],h=24;const y=["animals","flowers","mascha"];let L=0,f=0,T=-1;const v=[6,12,24,32,48];let M,w=2,E=2,C=[],k=[],H=[];function b(e){for(p=e.length-1;p>0;p-=1){const t=Math.floor(Math.random()*(p+1));[e[p],e[t]]=[e[t],e[p]]}return e}function N(){n.classList.remove("popup-init"),n.classList.remove("popup-hide"),n.classList.add("popup-show")}function P(){n.classList.remove("popup-show"),n.classList.add("popup-hide")}function B(){3===(f+=1)&&(T=0)}function A(n){let a=parseInt(n.target.getAttribute("data-step"));L+a>=0&&L+a<y.length+T&&(L+=a,s("lTheme").innerHTML=t[e].themes_txt[L],s("iTheme").src="images/"+y[L]+".svg")}function x(n){let a=parseInt(n.target.getAttribute("data-step"));w+a>=0&&w+a<v.length&&(w+=a,s("lCards").innerHTML=v[w]+" "+t[e].cards,s("iCards").src="images/cards"+v[w]+".svg")}function S(n){let a=parseInt(n.target.getAttribute("data-step"));E+a>0&&E+a<6&&(E+=a,s("iPlayers").src="images/player"+E+".svg",s("lPlayers").innerHTML=1===E?E+" "+t[e].player:E+" "+t[e].players)}function I(){let e=.7*Math.sqrt((document.documentElement.clientHeight-40)*document.documentElement.clientWidth/v[w]);c.setAttribute("style","grid-template-columns: repeat(auto-fill, minmax("+e+"px, 1fr))"),document.getElementsByTagName("header")[0].setAttribute("style","display: flex; flex-wrap: wrap;"),s("iStart").getBoundingClientRect().bottom>window.innerHeight&&document.getElementsByTagName("header")[0].setAttribute("style","display: flex; flex-wrap: nowrap;")}function D(n){return function(){!function(n){if(n.classList.contains("turned"))2===g.length&&g.includes(n)&&(g[0].classList.remove("turned"),g[1].classList.remove("turned"),g=[]);else if(2===g.length&&(g[0].classList.remove("turned"),g[1].classList.remove("turned"),g=[]),g.push(n),k[M]+=1,2===g.length&&(g[0].getElementsByClassName("image")[0].src===g[1].getElementsByClassName("image")[0].src?(C[M]+=1,1===C[M]?s("iMessage").innerHTML=t[e].player+" "+(M+1)+" "+t[e].has+" "+C[M]+" "+t[e].pair+".":s("iMessage").innerHTML=t[e].player+" "+(M+1)+" "+t[e].has+" "+C[M]+" "+t[e].pairs+".",g=[]):((M+=1)===E&&(M=0),s("iMessage").innerHTML=t[e].turn.replace("lPlayer",t[e].player+" "+(M+1)))),n.classList.toggle("turned"),c.getElementsByClassName("turned").length===v[w]){if(1===E)l.classList.add("hidden"),s("lWinner").innerHTML=t[e].stats.replace("lCards",v[w]/2).replace("lTries",k[0]/2);else{const n=document.createElement("tbody");let a,r,i,o="";for(l.classList.remove("hidden"),H=[],l.replaceChild(n,l.getElementsByTagName("tbody")[0]),p=0;p<E;p+=1)H.push({player:p+1,pairs:C[p],tries:k[p]/2});for(H.sort((e,t)=>t.pairs-e.pairs||e.tries-t.tries),p=0;p<E;p+=1)H[p].rank=p+1,p>0&&H[p-1].pairs===H[p].pairs&&(H[p].rank=H[p-1].rank),1===H[p].rank&&(o+=", "+H[p].player),(r=(a=n.insertRow()).insertCell(0)).innerHTML=H[p].rank,(r=a.insertCell(1)).innerHTML=t[e].player+" "+H[p].player,(r=a.insertCell(2)).innerHTML=H[p].pairs,(r=a.insertCell(3)).innerHTML=H[p].tries;(i=o.lastIndexOf(","))>0?(o=o.substring(2,i)+" "+t[e].and+o.substring(i+1),s("lWinner").innerHTML=t[e].players+" "+o+" "+t[e].win2+" "+H[0].pairs+" "+t[e].pairs2+"."):s("lWinner").innerHTML=t[e].player+" "+H[0].player+" "+t[e].win+" "+H[0].pairs+" "+t[e].pairs2+"."}a.classList.remove("popup-init"),a.classList.remove("popup-hide"),a.classList.add("popup-show")}}(n)}}function R(){let n=[],a=[];for(c.innerHTML="",C=new Array(E).fill(0),k=new Array(E).fill(0),M=0,g=[],s("iMessage").innerHTML=t[e].player+" 1 "+t[e].begin,p=0;p<h;p+=1)n.push(p+1);for(b(n),p=0;p<v[w]/2;p+=1)a.push(n[p]),a.push(n[p]);for(b(a),p=0;p<v[w];p+=1)(u=s("iDummy").getElementsByClassName("flip-container")[0].cloneNode(!0)).getElementsByClassName("image")[0].src="images/"+y[L]+"/"+a[p]+".jpg",c.appendChild(u);for(p=0;p<m.length;p+=1)m[p].onclick=D(m[p]);I(),r.classList.remove("swipe-out-right"),i.classList.remove("swipe-in-left"),r.classList.add("swipe-out"),i.classList.add("swipe-in")}function q(){r.classList.remove("swipe-out"),i.classList.remove("swipe-in"),r.classList.add("swipe-out-right"),i.classList.add("swipe-in-left")}function z(){a.classList.remove("popup-show"),a.classList.add("popup-hide"),setTimeout(function(){q()},600)}function G(e){let t=new URLSearchParams(window.location.search);return!!t.has(e)&&t.get(e)}window.addEventListener("resize",function(){I()}),function(){const n=(G("lang")||navigator.language||navigator.browserLanguage||(navigator.languages||["en"])[0]).substring(0,2).toLowerCase();"de"===n?e=1:"fr"===n?e=2:"es"===n&&(e=3),e&&document.documentElement.setAttribute("lang",n),s("lTheme").innerHTML=t[e].themes_txt[L],s("lCards").innerHTML=v[w]+" "+t[e].cards,s("lPlayers").innerHTML=E+" "+t[e].players,s("lStart").innerHTML=t[e].start,o.innerHTML=t[e].dev,s("lInstr").innerHTML=t[e].help,s("lLook").innerHTML=t[e].look,s("thRank").innerHTML=t[e].rank,s("thPlayer").innerHTML=t[e].player,s("thPairs").innerHTML=t[e].pairs,s("thTries").innerHTML=t[e].tries,document.querySelector("meta[name='description']").setAttribute("content",t[e].desc),s("iInfo").addEventListener("click",N),s("iInfoClose").addEventListener("click",P),s("iNextTheme").addEventListener("click",A),s("iPrevTheme").addEventListener("click",A),s("iCardsUp").addEventListener("click",x),s("iCardsDown").addEventListener("click",x),s("iPlayersUp").addEventListener("click",S),s("iPlayersDown").addEventListener("click",S),s("iStart").addEventListener("click",R),s("iClose").addEventListener("click",q),s("iOK").addEventListener("click",z),o.addEventListener("click",B),"true"===G("mascha")&&(T=0),document.querySelectorAll("tspan").forEach(function(e){e.innerHTML="grrd's Memo grrd's Memo grrd's Memo grrd's Memo grrd's Memo"}),document.querySelectorAll(".popup-head").forEach(function(e){e.appendChild(document.getElementsByClassName("title1")[0].cloneNode(!0)),e.appendChild(document.getElementsByClassName("title2")[0].cloneNode(!0))}),Array.from(d).forEach(function(e){var t;e.onclick=(t=e,function(){t.classList.toggle("turned")})}),document.querySelectorAll(".popup-head .title2card").forEach(function(e){e.classList.add("turned")}),setTimeout(function(){document.getElementsByClassName("cardM")[0].classList.add("turned")},500),setTimeout(function(){document.getElementsByClassName("cardE")[0].classList.add("turned")},1e3),setTimeout(function(){document.getElementsByClassName("cardM")[0].classList.remove("turned")},1700),setTimeout(function(){document.getElementsByClassName("cardE")[0].classList.remove("turned")},1900),setTimeout(function(){document.getElementsByClassName("cardM2")[0].classList.add("turned")},2500),setTimeout(function(){document.getElementsByClassName("cardM")[0].classList.add("turned")},3e3),setTimeout(function(){document.getElementsByClassName("cardE")[0].classList.add("turned")},3700),setTimeout(function(){document.getElementsByClassName("cardO")[0].classList.add("turned")},4300),I()}()}();